registerChannelProviderLocal firstTime true
#
# Start at "2021-W04-Jan26-0952-21-CET"
#
# Version information:
# European Spallation Source ERIC : iocsh.bash (3.4.0-PID-8726)
#
# --->--> snip -->--> 
# Please Use Version and other environment variables
# in order to report or debug this shell
#
# HOSTDISPLAY=""
# WINDOWID="39845891"
# PWD="/home/dev/sources/ecmc_target_muts_logger/iocsh"
# USER="dev"
# LOGNAME="dev"
# EPICS_HOST_ARCH="linux-x86_64"
# EPICS_BASE="/home/dev/epics/base-7.0.4"
# E3_REQUIRE_NAME="require"
# E3_REQUIRE_VERSION="3.4.0"
# E3_REQUIRE_LOCATION="/home/dev/epics/base-7.0.4/require/3.4.0"
# E3_REQUIRE_BIN="/home/dev/epics/base-7.0.4/require/3.4.0/bin"
# E3_REQUIRE_DB="/home/dev/epics/base-7.0.4/require/3.4.0/db"
# E3_REQUIRE_DBD="/home/dev/epics/base-7.0.4/require/3.4.0/dbd"
# E3_REQUIRE_INC="/home/dev/epics/base-7.0.4/require/3.4.0/include"
# E3_REQUIRE_LIB="/home/dev/epics/base-7.0.4/require/3.4.0/lib"
# EPICS_DRIVER_PATH="/home/dev/epics/base-7.0.4/require/3.4.0/siteMods:/home/dev/epics/base-7.0.4/require/3.4.0/siteApps"
# EPICS_CA_AUTO_ADDR_LIST=""
# EPICS_CA_ADDR_LIST=""
# PATH="/home/dev/epics/base-7.0.4/require/3.4.0/bin:/home/dev/epics/base-7.0.4/bin/linux-x86_64:/opt/conda/condabin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/dev/.local/bin:/home/dev/bin"
# --->--> snip -->--> 
#
# Set REQUIRE_IOC for its internal PVs
epicsEnvSet REQUIRE_IOC "REQMOD:mcag-trgt-muts--8726"
#
# Enable an exit subroutine for sotfioc
dbLoadRecords "/home/dev/epics/base-7.0.4/db/softIocExit.db" "IOC=REQMOD:mcag-trgt-muts--8726"
#
# Set E3_IOCSH_TOP for the absolute path where iocsh.bash is executed.
epicsEnvSet E3_IOCSH_TOP "/home/dev/sources/ecmc_target_muts_logger/iocsh"
#
# 
# Load require module, which has the version 3.4.0
# 
dlload /home/dev/epics/base-7.0.4/require/3.4.0/lib/linux-x86_64/librequire.so
dbLoadDatabase /home/dev/epics/base-7.0.4/require/3.4.0/dbd/require.dbd
require_registerRecordDeviceDriver
Loading module info records for require
# 
# Set E3_CMD_TOP for the absolute path where start_ioc.script exists
epicsEnvSet E3_CMD_TOP "/home/dev/sources/ecmc_target_muts_logger/iocsh"
#
iocshLoad 'start_ioc.script',''
##############################################################################
## Startscript for MUTS logger.
## One sin/cos 1VPP encoder input
## Four analog inputs for telemess distance sensors
## Timesatmped inputs for phase error calculation
##############################################################################
## Initiation:
epicsEnvSet("IOC" ,"IOC_TEST")
epicsEnvSet("ECMCCFG_INIT" ,"")  #Only run startup once (auto at PSI, need call at ESS), variable set to "#" in startup.cmd
epicsEnvSet("SCRIPTEXEC" ,"iocshLoad")
require ecmccfg develop
Module ecmccfg version develop found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/
Module ecmccfg has no library
Loading module info records for ecmccfg
require iocshutils 2.10.0  # For updateMenuConvert()
Module iocshutils version 2.10.0 found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/iocshutils/2.10.0/
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/iocshutils/2.10.0/lib/linux-x86_64/libiocshutils.so
Loaded iocshutils version 2.10.0
Loading dbd file /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/iocshutils/2.10.0/dbd/iocshutils.dbd
Calling function iocshutils_registerRecordDeviceDriver
Loading module info records for iocshutils
# run module startup.cmd (only needed at ESS  PSI auto call at require)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/startup.cmd, "IOC=IOC_TEST,ECMC_VER=develop,stream_VER=2.8.10, EC_RATE=1000"
#==============================================================================
# startup.cmd
on error halt
require ecmc        "develop"
Module ecmc version develop found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc/develop/
Module ecmc depends on asyn 4.37.0
Module asyn version 4.37.0 found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/asyn/4.37.0/
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/asyn/4.37.0/lib/linux-x86_64/libasyn.so
Loaded asyn version 4.37.0
Loading dbd file /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/asyn/4.37.0/dbd/asyn.dbd
Calling function asyn_registerRecordDeviceDriver
Loading module info records for asyn
Module ecmc depends on exprtk 1.2.1
Module exprtk version 1.2.1 found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/exprtk/1.2.1/
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/exprtk/1.2.1/lib/linux-x86_64/libexprtk.so
Loaded exprtk version 1.2.1
exprtk has no dbd file
Loading module info records for exprtk
Module ecmc depends on motor 7.0.4
Module motor version 7.0.4 found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/motor/7.0.4/
Module motor depends on asyn 4.37.0
Module asyn version 4.37.0 already loaded
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/motor/7.0.4/lib/linux-x86_64/libmotor.so
Loaded motor version 7.0.4
Loading dbd file /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/motor/7.0.4/dbd/motor.dbd
Calling function motor_registerRecordDeviceDriver
Loading module info records for motor
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc/develop/lib/linux-x86_64/libecmc.so
Loaded ecmc version develop
Loading dbd file /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc/develop/dbd/ecmc.dbd
Calling function ecmc_registerRecordDeviceDriver
Loading module info records for ecmc
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'ecmcMotorRecord'='EthercatMC'", "require  EthercatMC 3.0.2 # Using EthercatMC motor record support.","# Using ecmcMotorRecord motor record support.")
# Using ecmcMotorRecord motor record support.
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_CONFIG_ROOT",     "/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/")
epicsEnvSet("ECMC_CONFIG_DB",       "/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/db/")
epicsEnvSet("SCRIPTEXEC",           "iocshLoad")
epicsEnvSet("SM_PREFIX",            "IOC_TEST:")    # colon added since IOC is _not_ PREFIX
epicsEnvSet("ECMC_PROC_HOOK",       "")
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/initAll.cmd",1)
iocshLoad "/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/initAll.cmd"
#==============================================================================
# initAll.cmd
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/init.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/init.cmd
#==============================================================================
# init.cmd
epicsEnvSet("ECMC_ASYN_TIMEOUT",      1)                   # Asyn timeout
epicsEnvSet("ECMC_ASYN_ADDR",         0)                   # Asyn Address
epicsEnvSet("ECMC_MOTOR_PORT",        "NOT SET")
epicsEnvSet("ECMC_ASYN_PORT",         "NOT SET")
epicsEnvSet("ECMC_PREFIX",            "NOT SET")
epicsEnvSet("ECMC_GEN_EC_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_GEN_AX_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_EC_AXIS_HEALTH",    "NOT SET")
epicsEnvSet("ECMC_PLC_SAMPLE_RATE_MS", "NOT SET")
epicsEnvSet("ECMC_TSE",               -2)
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/initAxis.cmd",1)
iocshLoad "/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/initAxis.cmd"
#==============================================================================
# initAxis.cmd
epicsEnvSet("ECMC_MOTOR_NAME",            "NOT SET")
epicsEnvSet("ECMC_R",                     "NOT SET")
epicsEnvSet("ECMC_AXIS_NO",               "NOT SET")
epicsEnvSet("ECMC_DESC",                  "NOT SET")
epicsEnvSet("ECMC_EGU",                   "NOT SET")       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "NOT SET")       # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "NOT SET")       # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "NOT SET")       # Entry for axis health output (example: ec0.s1.BO_1.0)
epicsEnvSet("ECMC_ENC_SCALE_NUM",         "NOT SET")
epicsEnvSet("ECMC_ENC_SCALE_DENOM",       "NOT SET")
epicsEnvSet("ECMC_ENC_BITS",              "NOT SET")
epicsEnvSet("ECMC_ENC_TYPE",              "NOT SET")       # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "NOT SET")       # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_ENC_ABS_BITS",          "NOT SET")       # Absolute bit count (for absolute encoders) always least significant part
epicsEnvSet("ECMC_ENC_ABS_OFFSET",        "NOT SET")       # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_LATCHPOS",       "")              # Ethercat entry for latch position (only valid for home seq 11,12)
epicsEnvSet("ECMC_EC_ENC_LATCH_CONTROL",  "")              # Ethercat entry for latch control (only valid for home seq 11,12)
epicsEnvSet("ECMC_EC_ENC_LATCH_STATUS",   "")              # Ethercat entry for latch status (only valid for home seq 11,12)
epicsEnvSet("ECMC_DRV_SCALE_NUM",         "NOT SET")
epicsEnvSet("ECMC_DRV_SCALE_DENOM",       "NOT SET")
epicsEnvSet("ECMC_EC_DRV_CONTROL",        "NOT SET")       # Ethercat entry for control word or bit output
epicsEnvSet("ECMC_EC_DRV_STATUS",         "NOT SET")       # Ethercat entry for status word or bit input
epicsEnvSet("ECMC_EC_DRV_VELOCITY",       "NOT SET")       # Ethercat entry for velocity setpoint output
epicsEnvSet("ECMC_EC_DRV_BRAKE",          "NOT SET")       # Ethercat entry for brake output
epicsEnvSet("ECMC_EC_DRV_REDUCE_TORQUE",  "NOT SET")       # Ethercat entry for reduce torque output
epicsEnvSet("ECMC_DRV_BRAKE_OPEN_DLY_TIME",    "NOT SET")  # Brake timing parameter in cycles (default 1kHz)
epicsEnvSet("ECMC_DRV_BRAKE_CLOSE_AHEAD_TIME", "NOT SET")  # Brake timing parameter in cycles (default 1kHz)
epicsEnvSet("ECMC_VELO",                  "NOT SET")
epicsEnvSet("ECMC_JOG_VEL",               "NOT SET")
epicsEnvSet("ECMC_JAR",                   "NOT SET")       # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "NOT SET")
epicsEnvSet("ECMC_EMERG_DECEL",           "NOT SET")       # Emergency deceleration
epicsEnvSet("ECMC_HOME_PROC",              "NOT SET")
epicsEnvSet("ECMC_HOME_POS",               "NOT SET")
epicsEnvSet("ECMC_HOME_VEL_TO",            "NOT SET")
epicsEnvSet("ECMC_HOME_VEL_FRM",           "NOT SET")
epicsEnvSet("ECMC_HOME_ACC",               "NOT SET")
epicsEnvSet("ECMC_HOME_DEC",               "NOT SET")
epicsEnvSet("ECMC_HOME_LATCH_COUNT_OFFSET","0")
epicsEnvSet("ECMC_CNTRL_KP",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KI",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KD",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KFF",             "NOT SET")
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "NOT SET")       #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "NOT SET")       #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "NOT SET")       #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "NOT SET")       #  Ethercat entry for external interlock input
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "NOT SET")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "NOT SET")
epicsEnvSet("ECMC_DXLM_ENABLE",           "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX",          "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "NOT SET")
epicsEnvSet("ECMC_EGU",               "mm")
epicsEnvSet("ECMC_PREC",              3)
epicsEnvSet("ECMC_AXISFIELDINIT",     "")                  # Extra field init to motor record
epicsEnvSet("ECMC_AXISCONFIG",        "")                  # Extra parameters to driver
############################################################
############# ASYN2021/01/26 09:52:21.660 
ECMC Initializes.............
2021/01/26 09:52:21.660 ESS Open Source EtherCAT Motion Control Epics Module2021/01/26 09:52:21.660 
Mode: Configuration
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
2021/01/26 09:52:21.660 OK
 Configuration:
epicsEnvSet("ECMC_MOTOR_PORT"     "MCU1")
epicsEnvSet("ECMC_ASYN_PORT"      "MC_CPU1")
epicsEnvSet("ECMC_PREFIX"         "IOC_TEST:")
ecmcAsynPortDriverConfigure(MC_CPU1,1000,0,0,100)
ecmcAsynPortDriverConfigure: portName = MC_CPU1, paramTableSize = 1000, disableAutoConnect = 0, priority = 0, defaultSampleRateMS = 100.000000
asynOctetSetOutputEos(MC_CPU1, -1, ";\n")
asynOctetSetInputEos(MC_CPU1, -1, ";\n")
asynSetTraceMask(MC_CPU1, -1, 0x41)
asynSetTraceIOMask(MC_CPU1, -1, 6)
asynSetTraceInfoMask(MC_CPU1, -1, 1)
ecmcMotorRecordCreateController(MCU1, MC_CPU1, "64", 200, 1000, "")
############################################################
############# Misc settings:
# Disable function call trace printouts
ecmcConfigOrDie "Cfg.SetEnableFuncCallDiag(0)"
# Disable on change printouts from objects (enable for easy logging)
ecmcConfigOrDie "Cfg.SetTraceMaskBit(15,0)"
# Choose to generate EPICS-records for EtherCAT-entries
# (For records use ECMC_GEN_EC_RECORDS="-records" otherwise ECMC_GEN_EC_RECORDS="")
epicsEnvSet("ECMC_GEN_EC_RECORDS",          "-records")
# Choose to generate EPICS-records for ax-entries (PosAct, SetPos,..)
# (For records use ECMC_GEN_AX_RECORDS="-records" otherwise ECMC_GEN_AX_RECORDS="")
epicsEnvSet("ECMC_GEN_AX_RECORDS",          "-records")
# Update records in 10ms (100Hz)
epicsEnvSet("ECMC_SAMPLE_RATE_MS",       "10")
# Set EtherCAT frequency (defaults to 1000)
ecmcConfigOrDie "Cfg.SetSampleRate(1000)"
epicsEnvSet("ECMC_EC_SAMPLE_RATE" ,1000)
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addMaster.cmd",1)
 iocshLoad "/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addMaster.cmd", "MASTER_ID=0"
#===============================================================================
# addMaster.cfg
epicsEnvSet("ECMC_EC_MASTER_ID"          "0")
# Claim master
ecmcConfigOrDie "Cfg.EcSetMaster(0)"
epicsEnvSet("ECMC_MASTER_ID" ,0)
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/setDiagnostics.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/setDiagnostics.cmd
#==============================================================================
# setDiagnostics.cmd
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
epicsEnvSet("ECMCCFG_INIT" ,"#")
dbLoadRecords ./bptTypeTelemessCalib.dbd
updateMenuConvert
Adding breakpoint table "typeTelemess32900_21875" to menuConvert.
Adding breakpoint table "typeTelemess33018_21876" to menuConvert.
Adding breakpoint table "typeTelemess33020_21877" to menuConvert.
Adding breakpoint table "typeTelemess33021_21878" to menuConvert.
dbDumpBreaktable
breaktable(typeTelemess32900_21875) {
	raw=2319.370000 slope=1.110766e-03 eng=0.000000
	raw=4119.930000 slope=8.738013e-04 eng=2.000000
	raw=6408.780000 slope=7.447181e-04 eng=4.000000
	raw=9094.360000 slope=6.619689e-04 eng=6.000000
	raw=12115.650000 slope=6.362639e-04 eng=8.000000
	raw=15259.000000 slope=6.425001e-04 eng=10.000000
	raw=18371.840000 slope=6.488640e-04 eng=12.000000
	raw=21454.150000 slope=6.488619e-04 eng=14.000000
	raw=24536.470000 slope=6.971823e-04 eng=16.000000
	raw=27405.160000 slope=8.623031e-04 eng=18.000000
	raw=29724.530000 slope=8.623031e-04 eng=20.000000
}
breaktable(typeTelemess33018_21876) {
	raw=2594.030000 slope=9.830264e-04 eng=0.000000
	raw=4119.930000 slope=7.228149e-04 eng=1.500000
	raw=6195.150000 slope=5.522604e-04 eng=3.000000
	raw=8911.260000 slope=4.818766e-04 eng=4.500000
	raw=12024.090000 slope=4.636914e-04 eng=6.000000
	raw=15259.000000 slope=4.866464e-04 eng=7.500000
	raw=18341.320000 slope=5.067157e-04 eng=9.000000
	raw=21301.560000 slope=4.551040e-04 eng=10.500000
	raw=24597.510000 slope=5.228868e-04 eng=12.000000
	raw=27466.200000 slope=7.801813e-04 eng=13.500000
	raw=29388.830000 slope=7.801813e-04 eng=15.000000
}
breaktable(typeTelemess33020_21877) {
	raw=2502.480000 slope=9.637563e-04 eng=0.000000
	raw=4058.0  0:0  PREOP  +  EK1100 EtherCAT-Koppler (2A E-Bus)
1  0:1  PREOP  +  EL5021 1Ch. Sin/Cos Encoder
2  0:2  PREOP  +  EL3174-0002 4K. Ana. Eingang  +/-10V, +/-20mA, 16 Bit, Galvanis
3  0:3  PREOP  +  EL9505 Netzteilklemme 5V
4  0:4  PREOP  +  EL1252-0050 2K. Fast Dig. Eingang 5V, 1µs, DC Latch
2021/01/26 09:52:21.664 OK
2021/01/26 09:52:21.664 OK
2021/01/26 09:52:21.665 OK
2021/01/26 09:52:21.676 OK
2021/01/26 09:52:21.676 OK
2021/01/26 09:52:21.676 OK
2021/01/26 09:52:21.676 OK
2021/01/26 09:52:21.676 OK
2021/01/26 09:52:21.676 OK
890000 slope=7.123353e-04 eng=1.500000
	raw=6164.640000 slope=5.522624e-04 eng=3.000000
	raw=8880.740000 slope=4.818766e-04 eng=4.500000
	raw=11993.570000 slope=4.593576e-04 eng=6.000000
	raw=15259.000000 slope=4.818751e-04 eng=7.500000
	raw=18371.840000 slope=5.173823e-04 eng=9.000000
	raw=21271.050000 slope=4.428057e-04 eng=10.500000
	raw=24658.540000 slope=5.585365e-04 eng=12.000000
	raw=27344.130000 slope=7.679902e-04 eng=13.500000
	raw=29297.280000 slope=7.679902e-04 eng=15.000000
}
breaktable(typeTelemess33021_21878) {
	raw=2532.990000 slope=9.830264e-04 eng=0.000000
	raw=4058.890000 slope=7.123353e-04 eng=1.500000
	raw=6164.640000 slope=5.585386e-04 eng=3.000000
	raw=8850.220000 slope=4.771979e-04 eng=4.500000
	raw=11993.570000 slope=4.593576e-04 eng=6.000000
	raw=15259.000000 slope=4.818751e-04 eng=7.500000
	raw=18371.840000 slope=5.067157e-04 eng=9.000000
	raw=21332.080000 slope=4.681078e-04 eng=10.500000
	raw=24536.470000 slope=4.964783e-04 eng=12.000000
	raw=27557.750000 slope=7.021617e-04 eng=13.500000
	raw=29694.010000 slope=7.021617e-04 eng=15.000000
}
##############################################################################
## Configure hardware:
system "ethercat slaves"
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "0")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addSlave.cmd, "SLAVE_ID=0, HW_DESC=EK1100"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "0")
epicsEnvSet("HW_DESC",            "EK1100")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEK1100.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEK1100.cmd "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EK1100")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x044c2c52")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,0,0x2,0x044c2c52)"
ecmcConfigOrDie "Cfg.EcAddSlave(0,0,0x2,0x044c2c52)"
ecmcFileExist(ecmcEK1100.substitutions,1,1)
dbLoadTemplate(ecmcEK1100.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=0,HWTYPE=EK1100,T_SMP_MS=10,TSE=-2,NELM=1")
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "0+1","%d")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "1")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addSlave.cmd, "SLAVE_ID=1, HW_DESC=EL5021, SUBST_FILE=../db/amo.substitutions"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "1")
epicsEnvSet("HW_DESC",            "EL5021")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL5021.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL5021.cmd "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL5021")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x139d3052")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,1,0x2,0x139d3052)"
ecmcConfigOrDie "Cfg.EcWriteSdo(1,0x1011,0x1,1684107116,4)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(1,0x2,0x139d3052,1,2,0x1600,0x7000,0x01,16,ENC_CONTROL)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(1,0x2,0x139d3052,1,2,0x1600,0x7000,0x11,32,VALUE)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(1,0x2,0x139d3052,2,3,0x1a00,0x6000,0x01,16,ENC_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(1,0x2,0x139d3052,2,3,0x1a00,0x6000,0x11,32,POSITION)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(1,0x2,0x139d3052,2,3,0x1a00,0x6000,0x12,32,LATCH_POSITION)"
ecmcFileExist(../db/amo.substitutions,1,1)
dbLoadTemplate(../db/amo.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL5021,T_SMP_MS=10,TSE=-2,NELM=1")
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "1+1","%d")
# Enable reset on c-latch (index track)
#ecmcConfigOrDie "Cfg.EcAddSdo($(ECMC_EC_SLAVE_NUM),0x8000,0x1,1,1)"
epicsEnvSet("ECM2021/01/26 09:52:21.677 OK
2021/01/26 09:52:21.786 OK
2021/01/26 09:52:21.786 OK
2021/01/26 09:52:21.786 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
C_EC_SLAVE_NUM",              "2")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addSlave.cmd, "SLAVE_ID=2, HW_DESC=EL3174_0to10V, SUBST_FILE=../db/telemessEddyCurrentSensors.substitutions"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "2")
epicsEnvSet("HW_DESC",            "EL3174_0to10V")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V.cmd "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL3174_0to10V")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x0c663052")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,2,0x2,0x0c663052)"
ecmcConfigOrDie "Cfg.EcWriteSdo(2,0x1011,0x1,1684107116,4)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a00,0x6000,0x1,16,CH1_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a00,0x6000,0x11,16,CH1_VALUE)"
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x800D")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x800D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x800D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a02,0x6010,0x1,16,CH2_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a02,0x6010,0x11,16,CH2_VALUE)"
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x801D")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x801D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x801D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a04,0x6020,0x1,16,CH3_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a04,0x6020,0x11,16,CH3_VALUE)"
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x802D")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x802D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x802D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
ecmcConfigOrDie "Cfg.EcAddEntryComplete(2,0x2,0x0c663052,2,3,0x1a06,0x6030,0x1,16,CH4_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplet2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.787 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
e(2,0x2,0x0c663052,2,3,0x1a06,0x6030,0x11,16,CH4_VALUE)"
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x803D")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x803D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x803D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
ecmcFileExist(../db/telemessEddyCurrentSensors.substitutions,1,1)
dbLoadTemplate(../db/telemessEddyCurrentSensors.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=2,HWTYPE=EL3174_0to10V,T_SMP_MS=10,TSE=-2,NELM=1")
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "2+1","%d")
# Configure analog sensors common (filter settings valid for all channles)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL31XX-Sensor-common.cmd
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8000")
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x15")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")       # 50Hz
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x15,0,2)"
# Example of default configuration of analog sensor CH0
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8000")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecm2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.789 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
cConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8000,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH1
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8010")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8010,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH2
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8020")
iocshLoad /home/dev/epics/base-2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
2021/01/26 09:52:21.790 OK
7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8020,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH3
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8030")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
2021/01/26 09:52:21.791 OK
SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(2,0x8030,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "3")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addSlave.cmd, "SLAVE_ID=3, HW_DESC=EL9505"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "3")
epicsEnvSet("HW_DESC",            "EL9505")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL9505.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL9505.cmd "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL9505")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x25213052")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,3,0x2,0x25213052)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(3,0x2,0x25213052,2,0,0x1a00,0x6000,0x1,1,POWER_OK)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(3,0x2,0x25213052,2,0,0x1a00,0x6000,0x2,1,OVERLOAD)"
ecmcFileExist(ecmcEL9505.substitutions,1,1)
dbLoadTemplate(ecmcEL9505.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=3,HWTYPE=EL9505,T_SMP_MS=10,TSE=-2,NELM=1")
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "3+1","%d")
#epicsEnvSet("ECMC_SAMPLE_RATE_MS", 1)
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "4")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/addSlave.cmd, "SLAVE_ID=4, HW_DESC=EL1252"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "4")
epicsEnvSet("HW_DESC",            "EL1252")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL1252.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/ecmcEL1252.cmd "NELM=1"
e2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.792 OK
2021/01/26 09:52:21.793 OK
2021/01/26 09:52:21.798 OK
picsEnvSet("ECMC_EC_HWTYPE"             "EL1252")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x04e43052")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,4,0x2,0x04e43052)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,0,0x1a00,0x6000,0x1,1,BI_1)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,0,0x1a01,0x6000,0x2,1,BI_2)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xae,8,CH1_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xaf,8,CH2_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb0,64,CH1_LATCH_POS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb8,64,CH1_LATCH_NEG)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc0,64,CH2_LATCH_POS)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc0,64,CH2_LATCH_NEG)"
ecmcFileExist(ecmcEL1252.substitutions,1,1)
dbLoadTemplate(ecmcEL1252.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=4,HWTYPE=EL1252,T_SMP_MS=10,TSE=-2,NELM=1")
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "4+1","%d")
#epicsEnvSet("ECMC_SAMPLE_RATE_MS", 10)
#Apply hardware configuration
ecmcConfigOrDie "Cfg.EcApplyConfig(1)"
##############################################################################
# Prepare FFT plugins
require ecmc_plugin_fft master  # to get access to db file..
Module ecmc_plugin_fft version master found in /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/
Module ecmc_plugin_fft depends on asyn 4.37.0
Module asyn version 4.37.0 already loaded
Module ecmc_plugin_fft depends on ecmc develop
Module ecmc version develop already loaded
Loading library /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so
Loaded ecmc_plugin_fft version master
ecmc_plugin_fft has no dbd file
Loading module info records for ecmc_plugin_fft
# Decide how many revs to FFT then calc buffer size
epicsEnvSet("ECMC_REVS_TO_FFT", 10)
epicsEnvSet("ECMC_FFT_RATE", 1000)
ecmcEpicsEnvSetCalc("ECMC_FFT_NELM",   "10*36.0/14.0*1000","%d")
# Scale sensors in mm (same as in ./db/telemessEddyCurrentSensors.substitutions)
# According to EL3174 doc: 0..10V is 0..30518  (10.737V = 32767)
# CH1 0..15mm =>  scale = 15/30518
# CH1 0..15mm =>  scale = 15/30518
# CH1 0..15mm =>  scale = 15/30518
ecmcEpicsEnvSetCalc("ECMC_CH1_3_SCALE", "15/30518","%lf")
epicsEnvShow(ECMC_CH1_3_SCALE) # = Scale of CH1..CH3
ECMC_CH1_3_SCALE=0.000492
# CH4 0..20mm =>  scale = 20/30518
ecmcEpicsEnvSetCalc("ECMC_CH4_SCALE",   "20/30518","%lf")
epicsEnvShow(ECMC_CH4_SCALE)   # = Scale of CH4
ECMC_CH4_SCALE=0.000655
# Scale encoder in deg (21 bit per rev)
ecmcEpicsEnvSetCalc("ECMC_ENC_SCALE",   "360/2097152","%lf")
##############################################################################
## Load plugin: FFT AMO encoder
epicsEnvSet(ECMC_FFT_ID, 0)
epicsEnvSet(ECMC_PLUGIN_FILNAME,"/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so")
epicsEnvSet(ECMC_PLUGIN_CONFIG,"SOURCE=ec0.s1.POSITION;RM_LIN=1;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000172 ;MODE=CONT;ENABLE=1;")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPlugin.cmd, "PLUGIN_ID=0,FILE=/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,CONFIG='SOURCE=ec0.s1.POSITION;RM_LIN=1;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000172 ;MODE=CONT;ENABLE=1;', REPORT=0"
#==============================================================================
# loadPlugin.cmd
ecmcConfigOrDie "Cfg.LoadPlugin(0,/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,SOURCE=ec0.s1.POSITION;RM_LIN=1;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000172 ;MODE=CONT;ENABLE=1;)"
ecmcEpicsEnvSetCalcTernary("ECMC_PLUGIN_REPORT", "0>0","","#")
#ecmcConfigO2021/01/26 09:52:21.801 OK
rDie "Cfg.ReportPlugin(0)"
epicsEnvUnset(ECMC_PLUGIN_REPORT);
# Note: INDEX is the index of FFT object in FFT plugin and not PLUGIN_ID. In this case the same
dbLoadRecords(ecmcPluginFFT.template,"P=IOC_TEST:,INDEX=0, NELM=25714, ,AMP_DESC='Position amplitude',AMP_EGU='Â°',RAW_DESC='Position',RAW_EGU='Â°',TITLE='FFT for rotational AMO encoder'")
##############################################################################
## Load plugin: FFT AI CH1 : Telemess 0..15
epicsEnvSet(ECMC_FFT_ID, 1)
epicsEnvSet(ECMC_PLUGIN_CONFIG,"SOURCE=ec0.s2.CH1_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPlugin.cmd, "PLUGIN_ID=1,FILE=/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,CONFIG='SOURCE=ec0.s2.CH1_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;', REPORT=1"
#==============================================================================
# loadPlugin.cmd
ecmcConfigOrDie "Cfg.LoadPlugin(1,/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,SOURCE=ec0.s2.CH1_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;)"
ecmcEpicsEnvSetCalcTernary("ECMC_PLUGIN_REPORT", "1>0","","#")
ecmcConfigOrDie "Cfg.ReportPlugin(1)"
Plugin info: 
  Index                = 1
  Name                 = ecmcPlugin_FFT
  Description          = FFT plugin for use with ecmc.
  Option description   = 
    DBG_PRINT=<1/0>    : Enables/disables printouts from plugin, default = disabled.
    SOURCE=<source>    : Sets source variable for FFT (example: ec0.s1.AI_1).
    NFFT=<nfft>        : Data points to collect, default = 4096.
    SCALE=scalefactor  : Apply scale to source data, default = 1.0.
    RM_DC=<1/0>        : Remove DC offset of input data (SOURCE), default = disabled.
    RM_LIN=<1/0>       : Remove linear component in data (SOURCE) by least square, default = disabled.
    ENABLE=<1/0>       : Enable data acq. and calcs (can be controlled over asyn), default = disabled.
    MODE=<CONT/TRIGG>  : Continious or triggered mode, defaults to TRIGG
    RATE=<rate in hz>  : fft data sample rate in hz (must be lower than ecmc rate and (ecmc_rate/fft_rate)=integer), default = ecmc rate.
  Filename             = /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so
  Config string        = SOURCE=ec0.s2.CH1_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;
  Version              = 2
  Interface version    = 65536 (ecmc = 65536)
     max plc funcs     = 64
     max plc func args = 10
     max plc consts    = 64
  Construct func       = @0x7f163ee7a900
  Enter realtime func  = @0x7f163ee7a950
  Exit realtime func   = @0x7f163ee7a8f0
  Realtime func        = @0x7f163ee7a8e0
  Destruct func        = @0x7f163ee7a920
  dlhandle             = @0x101daa0
  Plc functions:
    funcs[00]:
      Name       = "fft_clear(arg0);"
      Desc       = double fft_clear(index) : Clear/reset fft[index].
      Arg count  = 1
      func       = @0x7f163ee7a960
    funcs[01]:
      Name       = "fft_enable(arg0, arg1);"
      Desc       = double fft_enable(index, enable) : Set enable for fft[index].
      Arg count  = 2
      func       = @0x7f163ee7a980
    funcs[02]:
      Name       = "fft_trigg(arg0);"
      Desc       = double fft_trigg(index) : Trigg new measurement for fft[index]. Will clear buffers.
      Arg count  = 1
      func       = @0x7f163ee7a9a0
    funcs[03]:
      Name       = "fft_mode(arg0, arg1);"
      Desc       = double fft_mode(index, mode) : Set mode Cont(1)/Trigg(2) for fft[index].
      Arg count  = 2
      func       = @0x7f163ee7a9c0
    funcs[04]:
      Name       = "fft_stat(arg0);"
      Desc       = double fft_stat(index) : Get status of fft (NO_STAT, IDLE, ACQ, CALC) for fft[index].
      Arg count  = 1
      func       = @0x7f163ee7a9e0
  Plc constants:
    consts[00]:2021/01/26 09:52:21.801 OK
2021/01/26 09:52:21.805 OK
2021/01/26 09:52:21.808 OK

      Name     = "fft_CONT" = 1.000
      Desc     = FFT Mode: Continious
    consts[01]:
      Name     = "fft_TRIGG" = 2.000
      Desc     = FFT Mode :Triggered
    consts[02]:
      Name     = "fft_NO_STAT" = 0.000
      Desc     = FFT Status: Invalid state
    consts[03]:
      Name     = "fft_IDLE" = 1.000
      Desc     = FFT Status: Idle state (waiting for trigger)
    consts[04]:
      Name     = "fft_ACQ" = 2.000
      Desc     = FFT Status: Acquiring data
    consts[05]:
      Name     = "fft_CALC" = 3.000
      Desc     = FFT Status: Calculating result

epicsEnvUnset(ECMC_PLUGIN_REPORT);
# Note: INDEX is the index of FFT object in FFT plugin and not PLUGIN_ID. In this case the same
dbLoadRecords(ecmcPluginFFT.template,"P=IOC_TEST:,INDEX=1, NELM=25714,AMP_DESC='Position amplitude',AMP_EGU='mm',RAW_DESC='Position',RAW_EGU='mm',TITLE='FFT for Telemess sensor 0Â°'")
##############################################################################
## Load plugin: FFT AI CH2 : Telemess 0..15
epicsEnvSet(ECMC_FFT_ID, 2)
epicsEnvSet(ECMC_PLUGIN_CONFIG,"SOURCE=ec0.s2.CH2_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPlugin.cmd, "PLUGIN_ID=2,FILE=/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,CONFIG='SOURCE=ec0.s2.CH2_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;', REPORT=0"
#==============================================================================
# loadPlugin.cmd
ecmcConfigOrDie "Cfg.LoadPlugin(2,/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,SOURCE=ec0.s2.CH2_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;)"
ecmcEpicsEnvSetCalcTernary("ECMC_PLUGIN_REPORT", "0>0","","#")
#ecmcConfigOrDie "Cfg.ReportPlugin(2)"
epicsEnvUnset(ECMC_PLUGIN_REPORT);
# Note: INDEX is the index of FFT object in FFT plugin and not PLUGIN_ID. In this case the same
dbLoadRecords(ecmcPluginFFT.template,"P=IOC_TEST:,INDEX=2, NELM=25714,AMP_DESC='Position amplitude',AMP_EGU='mm',RAW_DESC='Position',RAW_EGU='mm',TITLE='FFT for Telemess sensor 120Â°'")
##############################################################################
## Load plugin: FFT AI CH3 : Telemess 0..15
epicsEnvSet(ECMC_FFT_ID, 3)
epicsEnvSet(ECMC_PLUGIN_CONFIG,"SOURCE=ec0.s2.CH3_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPlugin.cmd, "PLUGIN_ID=3,FILE=/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,CONFIG='SOURCE=ec0.s2.CH3_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;', REPORT=0"
#==============================================================================
# loadPlugin.cmd
ecmcConfigOrDie "Cfg.LoadPlugin(3,/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,SOURCE=ec0.s2.CH3_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000492;MODE=CONT;ENABLE=1;)"
ecmcEpicsEnvSetCalcTernary("ECMC_PLUGIN_REPORT", "0>0","","#")
#ecmcConfigOrDie "Cfg.ReportPlugin(3)"
epicsEnvUnset(ECMC_PLUGIN_REPORT);
# Note: INDEX is the index of FFT object in FFT plugin and not PLUGIN_ID. In this case the same
dbLoadRecords(ecmcPluginFFT.template,"P=IOC_TEST:,INDEX=3, NELM=25714, ,AMP_DESC='Position amplitude',AMP_EGU='mm',RAW_DESC='Position',RAW_EGU='mm',TITLE='FFT for Telemess sensor 240Â°'")
##############################################################################
## Load plugin: FFT AI CH4 : Telemess 0..20
epicsEnvSet(ECMC_FFT_ID, 4)
epicsEnvSet(ECMC_PLUGIN_CONFIG,"SOURCE=ec0.s2.CH4_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000655;MODE=CONT;ENABLE=1;")
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPlugin.cmd, "PLUGIN_ID=4,FILE=/home/dev/epics/base-7.0.4/re2021/01/26 09:52:21.811 OK
2021/01/26 09:52:21.817 OK
2021/01/26 09:52:21.817 OK
2021/01/26 09:52:21.821 OK
2021/01/26 09:52:21.821 OK
2021/01/26 09:52:21.821 OK
2021/01/26 09:52:21.822 ../devEcmcSup/plc/ecmcPLCDataIF.cpp/parseAndLinkEcDataSource:1265: WARNING: Entry ec0.s4.CH2_LATCH_POS is of type S64, U64 or undefined. PLC values are doubles and might not be able to represent the ethercat value correct.
2021/01/26 09:52:21.822 ../devEcmcSup/plc/ecmcPLCDataIF.cpp/parseAndLinkEcDataSource:1265: WARNING: Entry ec0.s4.CH1_LATCH_POS is of type S64, U64 or undefined. PLC values are doubles and might not be able to represent the ethercat value correct.
2021/01/26 09:52:21.823 INFO: Locking memory
2021/01/26 09:52:21.823 WARNING: mlockall() failed (0x20045).
2021/01/26 09:52:21.827 Starting up EtherCAT bus: 0 second(s). Max wait time 30 second(s).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 0: Not operational (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 1: Not operational (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 2: Not operational (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 3: Not operational (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 4: Not operational (0x24011).
2021/01/26 09:52:21.924 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2021/01/26 09:52:22.531 ../devEcmcSup/main/ecmcError.cpp/errorReset:103: NO_ERROR (0x0).
2021/01/26 09:52:23.828 EtherCAT bus started!
2021/01/26 09:52:23.828 OK
2021/01/26 09:52:23.828 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocBuild (0). Allow callbacks: true.
Starting iocInit
2021/01/26 09:52:23.828 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtBeginning (1). Allow callbacks: true.
quire/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,CONFIG='SOURCE=ec0.s2.CH4_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000655;MODE=CONT;ENABLE=1;', REPORT=0"
#==============================================================================
# loadPlugin.cmd
ecmcConfigOrDie "Cfg.LoadPlugin(4,/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmc_plugin_fft/master/lib/linux-x86_64/libecmc_plugin_fft.so,SOURCE=ec0.s2.CH4_VALUE;DBG_PRINT=0;NFFT=25714;RATE=1000;RM_DC=1;SCALE=0.000655;MODE=CONT;ENABLE=1;)"
ecmcEpicsEnvSetCalcTernary("ECMC_PLUGIN_REPORT", "0>0","","#")
#ecmcConfigOrDie "Cfg.ReportPlugin(4)"
epicsEnvUnset(ECMC_PLUGIN_REPORT);
# Note: INDEX is the index of FFT object in FFT plugin and not PLUGIN_ID. In this case the same
dbLoadRecords(ecmcPluginFFT.template,"P=IOC_TEST:,INDEX=4, NELM=25714,AMP_DESC='Position amplitude',AMP_EGU='mm',RAW_DESC='Position',RAW_EGU='mm',TITLE='FFT for Telemess sensor vertical'")
##############################################################################
## PLC 0: For calculating the phase error
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/loadPLCFile.cmd, "PLC_ID=0, SAMPLE_RATE_MS=10,FILE=./plc/phaseError.plc, PLC_MACROS='DBG=#,PLC_ID=0,PHOTOCELL_POSTIME=ec0.s4.CH1_LATCH_POS,TIMING_POSTIME=ec0.s4.CH2_LATCH_POS,MIN_PHASE_ERROR=0,MAX_PHASE_ERROR=5'")
#==============================================================================
# loadPLCFile.cmd
epicsEnvSet("ECMC_PLC_ID",              "0")
epicsEnvSet("ECMC_PLC_SAMPLE_RATE_MS",  "10") # execute at 1000Hz
epicsEnvSet("ECMC_TMP_FILE",            "/tmp/PLC0.plc")
ecmcFileExist("./plc/phaseError.plc",1)
system "msi -V -M 'DBG=#,PLC_ID=0,PHOTOCELL_POSTIME=ec0.s4.CH1_LATCH_POS,TIMING_POSTIME=ec0.s4.CH2_LATCH_POS,MIN_PHASE_ERROR=0,MAX_PHASE_ERROR=5' ./plc/phaseError.plc > /tmp/PLC0.plc"
ecmcFileExist("/tmp/PLC0.plc",1)
ecmcConfigOrDie "Cfg.CreatePLC(0,10)"
ecmcConfigOrDie "Cfg.LoadPLCFile(0,/tmp/PLC0.plc)"
system "rm -f /tmp/PLC0.plc"
ecmcFileExist("ecmcPlc.db",1,1)
dbLoadRecords("ecmcPlc.db", "PORT=MC_CPU1,A=0,Index=0,Name=IOC_TEST:")
dbLoadRecords("ecmcPlcAnalog.db","P=IOC_TEST:,PORT=MC_CPU1,ASYN_NAME=plcs.plc0.static.phaseErrorMM,REC_NAME=-PhaseErrorMM,TSE=0,T_SMP_MS=10")
##############################################################################
############# Cleanup:
epicsEnvUnset(ECMC_FFT_ID)
epicsEnvUnset(ECMC_FFT_NELM)
epicsEnvUnset(ECMC_REVS_TO_FFT)
epicsEnvUnset(ECMC_PLUGIN_CONFIG)
epicsEnvUnset(ECMC_PLUGIN_FILNAME)
epicsEnvUnset(ECMC_CH1_3_SCALE)
epicsEnvUnset(ECMC_CH4_SCALE)
epicsEnvUnset(ECMC_ENC_SCALE)
##############################################################################
############# Configure diagnostics:
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
# go active
iocshLoad (/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/setAppMode.cmd)
#==============================================================================
# setAppMode.cmd
ecmcFileExist("/home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/general.cmd",1)
iocshLoad /home/dev/epics/base-7.0.4/require/3.4.0/siteMods/ecmccfg/develop/general.cmd
#==============================================================================
# general.cmd
ecmcFileExist("ecmcGeneral.db",1,1)
dbLoadRecords("ecmcGeneral.db","P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2,ECMC_PROC_HOOK=")
# Examples of commands for info:
# ecmcReport <level> or asynReport <level>
# ecmcReport 3
# ecmcGrepParam <pattern>
# List all ecmc params for ethercat slave 2:
# ecmcGrepParam *s2*
#
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("ecmcEc.db",1,1)
 dbLoadRecords("ecmcEc.db","P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,T_SMP_MS=10,TSE=-2")
ecmcConfigOrDie "Cfg.SetAppMode(1)"
iocInit()
############################################################################
## EPICS R7.0.4-E3-7.0.4-patch
## Rev. 2021-01-19T11:34+0100
###########################2021/01/26 09:52:23.829 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCallbackInit (2). Allow callbacks: true.
2021/01/26 09:52:23.829 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaLinkInit (3). Allow callbacks: true.
2021/01/26 09:52:23.829 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDrvSup (4). Allow callbacks: true.
2021/01/26 09:52:23.829 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitRecSup (5). Allow callbacks: true.
2021/01/26 09:52:23.829 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDevSup (6). Allow callbacks: true.
2021/01/26 09:52:23.831 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.plc0.enable linked to record (asyn reason 1).
2021/01/26 09:52:23.831 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.reset linked to record (asyn reason 2).
2021/01/26 09:52:23.831 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.plc0.static.phaseErrorMM linked to record (asyn reason 3).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.ENC_STATUS linked to record (asyn reason 4).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH1_STATUS linked to record (asyn reason 5).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH2_STATUS linked to record (asyn reason 6).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH3_STATUS linked to record (asyn reason 7).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH4_STATUS linked to record (asyn reason 8).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH1_STATUS linked to record (asyn reason 9).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH2_STATUS linked to record (asyn reason 10).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.msg linked to record (asyn reason 11).
2021/01/26 09:52:23.832 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.updated linked to record (asyn reason 12).
2021/01/26 09:52:23.833 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.slavestatus linked to record (asyn reason 13).
2021/01/26 09:52:23.833 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.slavestatus linked to record (asyn reason 14).
2021/01/26 09:52:23.833 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.slavestatus linked to record (asyn reason 15).
2021/01/26 09:52:23.833 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.slavestatus linked to record (asyn reason 16).
2021/01/26 09:52:23.833 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.slavestatus linked to record (asyn reason 17).
2021/01/26 09:52:23.834 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.masterstatus linked to record (asyn reason 18).
2021/01/26 09:52:23.834 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.slavecounter linked to record (asyn reason 19).
2021/01/26 09:52:23.834 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.memmapcounter linked to record (asyn reason 20).
2021/01/26 09:52:23.834 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainfailcountertotal linked to record (asyn reason 21).
2021/01/26 09:52:23.835 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.entrycounter linked to record (asyn reason 22).
2021/01/26 09:52:23.835 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainstatus linked to record (asyn reason 23).
2021/01/26 09:52:23.835 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.POWER_OK linked to record (asyn reason 24).
2021/01/26 09:52:23.836 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.OVERLOAD linked to record (asyn reason 25).
2021/01/26 09:52:23.836 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.BI_1 linked to record (asyn reason 26).
2021/01/26 09:52:23.837 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.BI_2 linked to record (asyn reason 27).
2021/01/26 09:52:23.837 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.ok linked to record (asyn reason 28).
2021/01/26 09:52:23.838 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.ONE linked to record (asyn reason 29).
2021/01/26 09:52:23.838 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.ZERO linked to record (asyn reason 30).
2021/01/26 09:52:23.839 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.ONE linked to record (asyn reason 31).
2021/01/26 09:52:23.839 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.ZERO linked to record (asyn reason 32).
2021/01/26 09:52:23.839 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ONE linked to record (asyn reason 33).
2021/01/26 09:52:23.840 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ZERO linked to record (asyn reason 34).
2021/01/26 09:52:23.840 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.ONE linked to record (asyn reason 35).
2021/01/26 09:52:23.841 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.ZERO linked to record (asyn reason 36).
2021/01/26 09:52:23.841 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.ONE linked to record (asyn reason 37).
2021/01/26 09:52:23.841 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.ZERO linked to record (asyn reason 38).
2021/01/26 09:52:23.842 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.POSITION linked to record (asyn reason 39).
2021/01/26 09:52:23.842 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH1_VALUE linked to record (asyn reason 40).
2021/01/26 09:52:23.843 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH2_VALUE linked to record (asyn reason 41).
2021/01/26 09:52:23.844 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH3_VALUE linked to record (asyn reason 42).
2021/01/26 09:52:23.844 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.CH4_VALUE linked to record (asyn reason 43).
2021/01/26 09:52:23.845 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH1_LATCH_POS linked to record (asyn reason 44).
2021/01/26 09:52:23.845 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH1_LATCH_NEG linked to record (asyn reason 45).
2021/01/26 09:52:23.846 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH2_LATCH_POS linked to record (asyn reason 46).
2021/01/26 09:52:23.846 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.CH2_LATCH_NEG linked to record (asyn reason 47).
2021/01/26 09:52:23.847 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.plc0.scantime linked to record (asyn reason 48).
2021/01/26 09:52:23.847 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.plc0.error linked to record (asyn reason 49).
2021/01/26 09:52:23.847 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.appmode linked to record (asyn reason 50).
2021/01/26 09:52:23.848 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.id linked to record (asyn reason 51).
2021/01/26 09:52:23.849 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.min linked to record (asyn reason 52).
2021/01/26 09:52:23.849 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.max linked to record (asyn reason 53).
2021/01/26 09:52:23.850 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.min linked to record (asyn reason 54).
2021/01/26 09:52:23.850 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.max linked to record (asyn reason 55).
2021/01/26 09:52:23.851 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.min linked to record (asyn reason 56).
2021/01/26 09:52:23.852 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.max linked to record (asyn reason 57).
2021/01/26 09:52:23.852 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.min linked to record (asyn reason 58).
2021/01/26 09:52:23.853 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.max linked to record (asyn reason 59).
2021/01/26 09:52:23.854 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDatabase (7). Allow callbacks: true.
2021/01/26 09:52:23.854 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterFinishDevSup (8). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterScanInit (9). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitialProcess (10). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (11). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocBuilt (12). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocRun (13). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterDatabaseRunning (14). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInterruptAccept (28). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaServerRunning (15). Allow callbacks: true.
2021/01/26 09:52:25.533 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (29). Allow callbacks: true.
iocRun: All initialization complete
2021/01/26 09:52:25.534 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocRunning (16). Allow callbacks: true.
#################################################
# Store Records to file
dbl > pvs.log
# Set the IOC Prompt String One 
epicsEnvSet IOCSH_PS1 "mcag-trgt-muts--8726 > "
#
[?1034hmcag-trgt-muts--8726 > 