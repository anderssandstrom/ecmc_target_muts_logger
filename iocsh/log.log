#
# Start at "2022-W42-Oct19-1521-34-CEST"
#
# Version information:
# European Spallation Source ERIC : iocsh (4.0.0-PID-23736)
#
# --->--> snip -->--> 
# Please Use Version and other environment variables
# in order to report or debug this shell
#
# HOSTDISPLAY=""
# WINDOWID="27263880"
# PWD="/home/anderssandstrom/source/ecmc_target_muts_logger/iocsh"
# USER="anderssandstrom"
# LOGNAME="anderssandstrom"
# EPICS_HOST_ARCH="linux-x86_64"
# EPICS_BASE="/epics/base-7.0.6.1"
# E3_REQUIRE_NAME="require"
# E3_REQUIRE_VERSION="4.0.0"
# E3_REQUIRE_LOCATION="/epics/base-7.0.6.1/require/4.0.0"
# E3_REQUIRE_BIN="/epics/base-7.0.6.1/require/4.0.0/bin"
# E3_REQUIRE_DB="/epics/base-7.0.6.1/require/4.0.0/db"
# E3_REQUIRE_DBD="/epics/base-7.0.6.1/require/4.0.0/dbd"
# E3_REQUIRE_INC="/epics/base-7.0.6.1/require/4.0.0/include"
# E3_REQUIRE_LIB="/epics/base-7.0.6.1/require/4.0.0/lib"
# EPICS_DRIVER_PATH="/epics/base-7.0.6.1/require/4.0.0/siteMods"
# EPICS_CA_AUTO_ADDR_LIST=""
# EPICS_CA_ADDR_LIST=""
# EPICS_PVA_AUTO_ADDR_LIST=""
# EPICS_PVA_ADDR_LIST=""
# PATH="/epics/base-7.0.6.1/require/4.0.0/bin:/epics/base-7.0.6.1/bin/linux-x86_64:/opt/conda/condabin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/anderssandstrom/.local/bin:/home/anderssandstrom/bin"
# --->--> snip -->--> 
#
# Set REQUIRE_IOC for its internal PVs
epicsEnvSet REQUIRE_IOC "REQMOD:mcag-trgt-muts--23736"
#
# Enable an exit subroutine for sotfioc
dbLoadRecords "/epics/base-7.0.6.1/db/softIocExit.db" "IOC=REQMOD:mcag-trgt-muts--23736"
#
# Set E3_IOCSH_TOP for the absolute path where iocsh is executed.
epicsEnvSet E3_IOCSH_TOP "/home/anderssandstrom/source/ecmc_target_muts_logger/iocsh"
#
# 
# Load require module, which has the version 4.0.0
# 
dlload /epics/base-7.0.6.1/require/4.0.0/lib/linux-x86_64/librequire.so
dbLoadDatabase /epics/base-7.0.6.1/require/4.0.0/dbd/require.dbd
require_registerRecordDeviceDriver
Loading module info records for require
# 
# Set E3_CMD_TOP for the absolute path where start_ioc_xyz.script exists
epicsEnvSet E3_CMD_TOP "/home/anderssandstrom/source/ecmc_target_muts_logger/iocsh"
#
iocshLoad 'start_ioc_xyz.script',''
##############################################################################
## Startscript for measuring accuracy of steppers
## All sensors in  normal MUTS logger and 2 additional micro-epsilon ILD2300 sensors
##
## Author: Anders Sandstr√∂m, anders.sandstrom@ess.eu
##
##############################################################################
## Initiation:
epicsEnvSet("IOC" ,"IOC_TEST")
epicsEnvSet("ECMCCFG_INIT" ,"")  #Only run startup once (auto at PSI, need call at ESS), variable set to "#" in startup.cmd
epicsEnvSet("SCRIPTEXEC" ,"iocshLoad")
require ecmccfg 8.0.0
Module ecmccfg version 8.0.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/lib/linux-x86_64/libecmccfg.so
Loaded ecmccfg version 8.0.0+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/dbd/ecmccfg.dbd
Calling function ecmccfg_registerRecordDeviceDriver
Loading module info records for ecmccfg
# run module startup.cmd (only needed at ESS  PSI auto call at require)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/startup.cmd, "IOC=IOC_TEST,ECMC_VER=8.0.0,EC_RATE=1000"
#==============================================================================
# startup.cmd
on error halt
require ecmc        "8.0.0"
Module ecmc version 8.0.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmc/8.0.0+0/
Module ecmc depends on asyn 4.42.0+0
Module asyn version 4.42.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/lib/linux-x86_64/libasyn.so
Loaded asyn version 4.42.0+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/dbd/asyn.dbd
Calling function asyn_registerRecordDeviceDriver
Loading module info records for asyn
Module ecmc depends on exprtk 1.2.1+0
Module exprtk version 1.2.1+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/exprtk/1.2.1+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/exprtk/1.2.1+0/lib/linux-x86_64/libexprtk.so
Loaded exprtk version 1.2.1+0
exprtk has no dbd file
Loading module info records for exprtk
Module ecmc depends on motor 7.0.7+0
Module motor version 7.0.7+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/
Module motor depends on asyn 4.42.0+0
Module asyn version 4.42.0+0 already loaded
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/lib/linux-x86_64/libmotor.so
Loaded motor version 7.0.7+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/dbd/motor.dbd
Calling function motor_registerRecordDeviceDriver
Loading module info records for motor
Module ecmc depends on ruckig 1.0.0+0
Module ruckig version 1.0.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/ruckig/1.0.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/ruckig/1.0.0+0/lib/linux-x86_64/libruckig.so
Loaded ruckig version 1.0.0+0
ruckig has no dbd file
Loading module info records for ruckig
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmc/8.0.0+0/lib/linux-x86_64/libecmc.so
Loaded ecmc version 8.0.0+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmc/8.0.0+0/dbd/ecmc.dbd
Calling function ecmc_registerRecordDeviceDriver
Loading module info records for ecmc
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'ecmcMotorRecord'='EthercatMC'", "require  EthercatMC 3.0.2 # Using EthercatMC motor record support.","# Using ecmcMotorRecord motor record support.")
# Using ecmcMotorRecord motor record support.
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_CONFIG_ROOT",     "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/")
epicsEnvSet("ECMC_CONFIG_DB",       "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/db/")
epicsEnvSet("SCRIPTEXEC",           "iocshLoad")
epicsEnvSet("SM_PREFIX",            "IOC_TEST:")    # colon added since IOC is _not_ PREFIX
epicsEnvSet("ECMC_PROC_HOOK",       "")
epicsEnvSet(ECMC_MODE, FULL)
ecmcEpicsEnvSetCalcTernary(ECMC_SUPPORT_MOTION, "'FULL'!='DAQ'","","# MODE == DAQ, DISABLING MOTION.")
epicsEnvShow(ECMC_SUPPORT_MOTION)
ECMC_SUPPORT_MOTION=
ecmcEpicsEnvSetCalcTernary(ECMC_USE_MOTOR_RECORD, "'FULL'=='FULL'","","# MODE != FULL, DISABLING MOTOR RECORD.")
epicsEnvShow(ECMC_USE_MOTOR_RECORD)
ECMC_USE_MOTOR_RECORD=
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/initAll.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/initAll.cmd"
#==============================================================================
# initAll.cmd
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/init.cmd",1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/init.cmd
#==============================================================================
# init.cmd
epicsEnvSet("ECMC_ASYN_TIMEOUT",      1)                   # Asyn timeout
epicsEnvSet("ECMC_ASYN_ADDR",         0)                   # Asyn Address
epicsEnvSet("ECMC_MOTOR_PORT",        "NOT SET")
epicsEnvSet("ECMC_ASYN_PORT",         "NOT SET")
epicsEnvSet("ECMC_PREFIX",            "NOT SET")
epicsEnvSet("ECMC_GEN_EC_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_GEN_AX_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_EC_AXIS_HEALTH",    "NOT SET")
epicsEnvSet("ECMC_PLC_SAMPLE_RATE_MS", "NOT SET")
epicsEnvSet("ECMC_TSE",               -2)
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/initAxis.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/initAxis.cmd"
#==============================================================================
# initAxis.cmd
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmc_axis_unset.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmc_axis_unset.cmd"
#==============================================================================
# ecmc_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_CNTRL_KP)
epicsEnvUnset(ECMC_CNTRL_KI)
epicsEnvUnset(ECMC_CNTRL_KD)
epicsEnvUnset(ECMC_CNTRL_KFF)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_EC_ENC_LATCHPOS)
epicsEnvUnset(ECMC_EC_ENC_LATCH_CONTROL)
epicsEnvUnset(ECMC_EC_ENC_LATCH_STATUS)
epicsEnvUnset(ECMC_HOME_LATCH_COUNT_OFFSET)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_DRV_CONTROL)
epicsEnvUnset(ECMC_EC_DRV_STATUS)
epicsEnvUnset(ECMC_EC_DRV_VELOCITY)
epicsEnvUnset(ECMC_EC_DRV_BRAKE)
epicsEnvUnset(ECMC_EC_DRV_REDUCE_TORQUE)
epicsEnvUnset(ECMC_EC_DRV_RESET)
epicsEnvUnset(ECMC_EC_DRV_ALARM_0)
epicsEnvUnset(ECMC_EC_DRV_ALARM_1)
epicsEnvUnset(ECMC_EC_DRV_ALARM_2)
epicsEnvUnset(ECMC_EC_DRV_WARNING)
epicsEnvUnset(ECMC_DRV_SCALE_DENOM)
epicsEnvUnset(ECMC_DRV_SCALE_NUM)
epicsEnvUnset(ECMC_DRV_BRAKE_OPEN_DLY_TIME)
epicsEnvUnset(ECMC_DRV_BRAKE_CLOSE_AHEAD_TIME)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_DXLM_ENABLE)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_DXLM_ENABLE)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmc_axis_sync_unset.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmc_axis_sync_unset.cmd"
#==============================================================================
# ecmc_axis_sync_unset.cmd
epicsEnvUnset(ECMC_CMD_FRM_OTHER_PLC_ENABLE)
epicsEnvUnset(ECMC_CMD_AXIS_PLC_ENABLE)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_1)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_2)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_3)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_4)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_5)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_6)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_7)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_8)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_9)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_10)
epicsEnvUnset(ECMC_ENC_VELO_FILT_SIZE)
epicsEnvUnset(ECMC_ENC_VELO_FILT_ENABLE)
epicsEnvUnset(ECMC_ENC_SOURCE)
epicsEnvUnset(ECMC_TRAJ_VELO_FILT_SIZE)
epicsEnvUnset(ECMC_TRAJ_VELO_FILT_ENABLE)
epicsEnvUnset(ECMC_TRAJ_SOURCE)
epicsEnvSet("ECMC_EGU",               "mm")
epicsEnvSet("ECMC_PREC",              3)
epicsEnvSet("ECMC_AXISFIELDINIT",     "")                  # Extra field init to motor record
epicsEnvSet("ECMC_AXISCONFIG",        "")                  # Extra parameters to driver
####################################2022/10/19 15:21:34.585 
ECMC Initializes.............
2022/10/19 15:21:34.585 ESS Open Source EtherCAT Motion Control Epics Module2022/10/19 15:21:34.585 
Mode: Configuration
2022/10/19 15:21:34.585 OK
2022/10/19 15:21:34.585 OK
2022/10/19 15:21:34.588 OK
2022/10/19 15:21:34.594 OK
2022/10/19 15:21:34.618 OK
2022/10/19 15:21:34.618 OK
2022/10/19 15:21:34.618 OK
########################
############# ASYN Configuration:
epicsEnvSet("ECMC_MOTOR_PORT"     "MCU1")
epicsEnvSet("ECMC_ASYN_PORT"      "MC_CPU1")
epicsEnvSet("ECMC_PREFIX"         "IOC_TEST:")
ecmcAsynPortDriverConfigure(MC_CPU1,1000,0,0,100)
ecmcAsynPortDriverConfigure: portName = MC_CPU1, paramTableSize = 1000, disableAutoConnect = 0, priority = 0, defaultSampleRateMS = 100.000000
asynOctetSetOutputEos(MC_CPU1, -1, ";\n")
asynOctetSetInputEos(MC_CPU1, -1, ";\n")
asynSetTraceMask(MC_CPU1, -1, 0x41)
asynSetTraceIOMask(MC_CPU1, -1, 6)
asynSetTraceInfoMask(MC_CPU1, -1, 1)
ecmcMotorRecordCreateController(MCU1, MC_CPU1, "64", 200, 1000, "")
############################################################
############# Misc settings:
# Disable function call trace printouts
ecmcConfigOrDie "Cfg.SetEnableFuncCallDiag(0)"
# Disable on change printouts from objects (enable for easy logging)
ecmcConfigOrDie "Cfg.SetTraceMaskBit(15,0)"
# Choose to generate EPICS-records for EtherCAT-entries
# (For records use ECMC_GEN_EC_RECORDS="-records" otherwise ECMC_GEN_EC_RECORDS="")
epicsEnvSet("ECMC_GEN_EC_RECORDS",          "-records")
# Choose to generate EPICS-records for ax-entries (PosAct, SetPos,..)
# (For records use ECMC_GEN_AX_RECORDS="-records" otherwise ECMC_GEN_AX_RECORDS="")
epicsEnvSet("ECMC_GEN_AX_RECORDS",          "-records")
# suffix for pva enabled scripts, templates and substitutions
ecmcEpicsEnvSetCalcTernary(ECMC_PVA, "0", "Pva","")
# Set EtherCAT frequency (defaults to 1000)
ecmcConfigOrDie "Cfg.SetSampleRate(1000)"
epicsEnvSet("ECMC_EC_SAMPLE_RATE" ,   1000)
ecmcEpicsEnvSetCalc("ECMC_EC_SAMPLE_RATE_MS" ,1000/1000)
# Update records in 10ms (100Hz) for FULL MODE and in EC_RATE for DAQ mode
ecmcEpicsEnvSetCalcTernary(ECMC_SAMPLE_RATE_MS, "'FULL'=='DAQ'","1","10")
epicsEnvSet("ECMC_P_SCRIPT",        "mXsXXX")
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addMaster.cmd",1)
 iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addMaster.cmd", "MASTER_ID=0"
#===============================================================================
# addMaster.cfg
epicsEnvSet("ECMC_EC_MASTER_ID"          "0")
# Claim master
ecmcConfigOrDie "Cfg.EcSetMaster(0)"
epicsEnvSet("ECMC_EC_MASTER_ID" ,0)
epicsEnvSet("ECMC_TMP_DIR",         "/tmp/IOC_TEST/EcMaster_0/")
system "mkdir -p /tmp/IOC_TEST/EcMaster_0/"
epicsEnvSet("ECMC_TMP_DIR",         "/tmp/IOC_TEST/EcMaster_0/")
system "mkdir -p /tmp/IOC_TEST/EcMaster_0/"
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/setDiagnostics.cmd",1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/setDiagnostics.cmd
#==============================================================================
# setDiagnostics.cmd
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
epicsEnvSet("ECMCCFG_INIT" ,"#")
##############################################################################
## Load breaktables with calibration data for Telemess sensors.
require iocshutils 2.10.0  # For updateMenuConvert()
Module iocshutils version 2.10.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/iocshutils/2.10.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/iocshutils/2.10.0+0/lib/linux-x86_64/libiocshutils.so
Loaded iocshutils version 2.10.0+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/iocshutils/2.10.0+0/dbd/iocshutils.dbd
Calling function iocshutils_registerRecordDeviceDriver
Loading module info records for iocshutils
dbLoadRecords ../src/bptTypeTelemessCalib_stainless.dbd
updateMenuConvert
Adding breakpoint table "typeTelemess32900_21875" to menuConvert.
Adding breakpoint table "typeTelemess33018_21876" to menuConvert.
Adding breakpoint table "typeTelemess33020_21877" to menuConvert.
Adding breakpoint table "typeTelemess33021_21878" to menuConvert.
dbDumpBreaktable
breaktable(typeTelemess32900_21875) {
	raw=-2594.030000 slope=4.748920e-04 eng=0.000000
	r 0  0:0   PREOP  +  EK1100 EtherCAT Coupler (2A E-Bus)
 1  0:1   PREOP  +  EK1110 EtherCAT-Verl‰ngerung
 2  0:2   PREOP  +  ILD2300
 3  0:3   PREOP  +  EK1100 EtherCAT-Koppler (2A E-Bus)
 4  0:4   PREOP  +  EL5021 1Ch. Sin/Cos Encoder
 5  0:5   PREOP  +  EL3174-0002 4K. Ana. Eingang  +/-10V, +/-20mA, 16 Bit, Galvanis
 6  0:6   PREOP  +  EL4122 2K. Ana. Ausgang 4-20mA, 16bit
 7  0:7   PREOP  +  EL9505 Netzteilklemme 5V
 8  0:8   PREOP  +  EL1252-0050 2K. Fast Dig. Eingang 5V, 1µs, DC Latch
 9  0:9   PREOP  +  EL9410 E-Bus Netzteilklemme (Diagnose)
10  0:10  PREOP  +  EL2004 4K. Dig. Ausgang 24V, 0.5A
11  0:11  PREOP  +  ILD2300
2022/10/19 15:21:34.662 OK
aw=1617.454000 slope=4.783584e-04 eng=2.000000
	raw=5798.420000 slope=5.904063e-04 eng=4.000000
	raw=9185.918000 slope=6.488623e-04 eng=6.000000
	raw=12268.236000 slope=6.687254e-04 eng=8.000000
	raw=15259.000000 slope=6.425009e-04 eng=10.000000
	raw=18371.836000 slope=7.201659e-04 eng=12.000000
	raw=21148.974000 slope=1.149738e-03 eng=14.000000
	raw=22888.500000 slope=1.985912e-03 eng=16.000000
	raw=23895.594000 slope=2.978868e-03 eng=18.000000
	raw=24566.990000 slope=2.978868e-03 eng=20.000000
}
breaktable(typeTelemess33018_21876) {
	raw=-2899.210000 slope=4.062093e-04 eng=0.000000
	raw=793.468000 slope=3.536066e-04 eng=1.500000
	raw=5035.470000 slope=3.870183e-04 eng=3.000000
	raw=8911.256000 slope=4.468302e-04 eng=4.500000
	raw=12268.236000 slope=5.015441e-04 eng=6.000000
	raw=15259.000000 slope=5.228864e-04 eng=7.500000
	raw=18127.692000 slope=7.447170e-04 eng=9.000000
	raw=20141.880000 slope=1.068507e-03 eng=10.500000
	raw=21545.708000 slope=1.489434e-03 eng=12.000000
	raw=22552.802000 slope=2.340539e-03 eng=13.500000
	raw=23193.680000 slope=2.340539e-03 eng=15.000000
}
breaktable(typeTelemess33020_21877) {
	raw=-2807.656000 slope=3.810180e-04 eng=0.000000
	raw=1129.166000 slope=3.561690e-04 eng=1.500000
	raw=5340.650000 slope=3.996042e-04 eng=3.000000
	raw=9094.364000 slope=4.636917e-04 eng=4.500000
	raw=12329.272000 slope=5.119929e-04 eng=6.000000
	raw=15259.000000 slope=5.461258e-04 eng=7.500000
	raw=18005.620000 slope=8.191887e-04 eng=9.000000
	raw=19836.700000 slope=9.637514e-04 eng=10.500000
	raw=21393.118000 slope=2.047972e-03 eng=12.000000
	raw=22125.550000 slope=2.586912e-03 eng=13.500000
	raw=22705.392000 slope=2.586912e-03 eng=15.000000
}
breaktable(typeTelemess33021_21878) {
	raw=-2868.692000 slope=4.028797e-04 eng=0.000000
	raw=854.504000 slope=3.461361e-04 eng=1.500000
	raw=5188.060000 slope=4.028797e-04 eng=3.000000
	raw=8911.256000 slope=4.388511e-04 eng=4.500000
	raw=12329.272000 slope=5.015441e-04 eng=6.000000
	raw=15320.036000 slope=5.401244e-04 eng=7.500000
	raw=18097.174000 slope=7.123380e-04 eng=9.000000
	raw=20202.916000 slope=1.092252e-03 eng=10.500000
	raw=21576.226000 slope=1.535979e-03 eng=12.000000
	raw=22552.802000 slope=2.234151e-03 eng=13.500000
	raw=23224.198000 slope=2.234151e-03 eng=15.000000
}
##############################################################################
## Configure hardware:
system "ethercat slaves"
# 0  0:0   OP     +  EK1100 EtherCAT Coupler (2A E-Bus)
# 1  0:1   PREOP  +  EK1110 EtherCAT-VerlÔøΩngerung
# 2  0:2   PREOP  +  ILD2300
# 3  0:3   PREOP  +  EK1100 EtherCAT-Koppler (2A E-Bus)
# 4  0:4   PREOP  +  EL5021 1Ch. Sin/Cos Encoder
# 5  0:5   PREOP  +  EL3174-0002 4K. Ana. Eingang  +/-10V, +/-20mA, 16 Bit, Galvanis
# 6  0:6   PREOP  +  EL4122 2K. Ana. Ausgang 4-20mA, 16bit
# 7  0:7   PREOP  +  EL9505 Netzteilklemme 5V
# 8  0:8   PREOP  +  EL1252-0050 2K. Fast Dig. Eingang 5V, 1ÔøΩs, DC Latch
# 9  0:9   PREOP  +  EL9410 E-Bus Netzteilklemme (Diagnose)
#10  0:10  PREOP  +  EL2004 4K. Dig. Ausgang 24V, 0.5A
#11  0:11  PREOP  +  ILD2300
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 100)
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "0")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=0, HW_DESC=EK1100"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "0")
epicsEnvSet("HW_DESC",            "EK1100")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1100.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1100.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EK1100")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x044c2c52")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,0,0x2,0x044c2c52)"
ecmcEpicsEnvSetCalcTernary2022/10/19 15:21:34.667 OK
2022/10/19 15:21:34.725 OK
2022/10/19 15:21:34.727 OK
(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddSlave(0,0,0x2,0x044c2c52)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=0,HWTYPE=EK1100"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "0","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s000")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s000-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEK1100.substitutions,ECMC_P=IOC_TEST:m0s000-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEK1100.substitutions,1,1)
dbLoadTemplate(ecmcEK1100.substitutions,"ECMC_P=IOC_TEST:m0s000-,ECMC_G=IOC_TEST:m0s000,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=0,HWTYPE=EK1100,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s000-,ECMC_G=IOC_TEST:m0s000"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s000-,ECMC_G=IOC_TEST:m0s000,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=0,HWTYPE=EK1100,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "0+1","%d")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "1")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=1, HW_DESC=EK1110"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "1")
epicsEnvSet("HW_DESC",            "EK1110")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1110.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1110.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EK1110")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x04562c52")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,1,0x2,0x04562c52)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddSlave(0,1,0x2,0x04562c52)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=1,HWTYPE=EK1110"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "1","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s001")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s001-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEK1110.substitutions,ECMC_P=IOC_TEST:m0s2022/10/19 15:21:34.750 OK
2022/10/19 15:21:34.752 OK
001-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEK1110.substitutions,1,1)
dbLoadTemplate(ecmcEK1110.substitutions,"ECMC_P=IOC_TEST:m0s001-,ECMC_G=IOC_TEST:m0s001,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EK1110,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s001-,ECMC_G=IOC_TEST:m0s001"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s001-,ECMC_G=IOC_TEST:m0s001,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EK1110,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "1+1","%d")
##Add optic sensor
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 10)
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "2")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=2, HW_DESC=OptoILD2300_100mm"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "2")
epicsEnvSet("HW_DESC",            "OptoILD2300_100mm")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcOptoILD2300_100mm.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcOptoILD2300_100mm.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "OptoILD2300_100mm")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x00000607")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x003ede78")
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd,1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,2,0x00000607,0x003ede78)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x00000607,0x003ede78,2,3,0x1a00,0x6065,0x5,S32,analogInput01,1)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=2,HWTYPE=OptoILD2300_100mm"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "2","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s002")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s002-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcOptoILD2300_100mm.substitutions,ECMC_P=IOC_TEST:m0s002-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcOptoILD2300_100mm.substitutions,1,1)
dbLoadTemplate(ecmcOptoILD2300_100mm.substitutions,"ECMC_P=IOC_TEST:m0s002-,ECMC_G=IOC_TEST:m0s002,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=2,HWTYPE=OptoILD2300_100mm,T_SMP_MS=10,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s002-,ECMC_G=IOC_TEST:m0s002"
#==============================================================================
# applyTemplate.cmd
ecmcFileE2022/10/19 15:21:34.768 OK
2022/10/19 15:21:34.770 OK
xist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s002-,ECMC_G=IOC_TEST:m0s002,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=2,HWTYPE=OptoILD2300_100mm,T_SMP_MS=10,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "2+1","%d")
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 100)
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "3")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=3, HW_DESC=EK1100"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "3")
epicsEnvSet("HW_DESC",            "EK1100")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1100.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEK1100.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EK1100")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x044c2c52")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,3,0x2,0x044c2c52)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddSlave(0,3,0x2,0x044c2c52)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=3,HWTYPE=EK1100"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "3","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s003")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s003-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEK1100.substitutions,ECMC_P=IOC_TEST:m0s003-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEK1100.substitutions,1,1)
dbLoadTemplate(ecmcEK1100.substitutions,"ECMC_P=IOC_TEST:m0s003-,ECMC_G=IOC_TEST:m0s003,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=3,HWTYPE=EK1100,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s003-,ECMC_G=IOC_TEST:m0s003"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s003-,ECMC_G=IOC_TEST:m0s003,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=3,HWTYPE=EK1100,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "3+1","%d")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "4")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=4, HW_DESC=EL5021, SUBST_FILE=../db/amo.substitutions"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "4")
epicsEnvSet("HW_DESC",            "EL5021")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL5021.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL5021.cmd" "NELM=1"
epicsEnvSet("ECMC_E2022/10/19 15:21:34.781 OK
2022/10/19 15:21:34.797 OK
2022/10/19 15:21:34.799 OK
2022/10/19 15:21:34.799 OK
2022/10/19 15:21:34.799 OK
2022/10/19 15:21:34.799 OK
2022/10/19 15:21:34.799 OK
2022/10/19 15:21:34.814 OK
C_HWTYPE"             "EL5021")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x139d3052")
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd,1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd "RESET=true"
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,4,0x2,0x139d3052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "true>0","","#- ")
ecmcConfigOrDie "Cfg.EcWriteSdo(4,0x1011,0x1,1684107116,4)"
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x139d3052,1,2,0x1600,0x7000,0x01,16,encoderControl01)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x139d3052,1,2,0x1600,0x7000,0x11,32,encoderValue01)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x139d3052,2,3,0x1a00,0x6000,0x01,16,encoderStatus01)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x139d3052,2,3,0x1a00,0x6000,0x11,32,positionActual01)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(4,0x2,0x139d3052,2,3,0x1a00,0x6000,0x12,32,encoderLatchPostion01)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=4,HWTYPE=EL5021"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "4","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s004")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s004-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=../db/amo.substitutions,ECMC_P=IOC_TEST:m0s004-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(../db/amo.substitutions,1,1)
dbLoadTemplate(../db/amo.substitutions,"ECMC_P=IOC_TEST:m0s004-,ECMC_G=IOC_TEST:m0s004,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=4,HWTYPE=EL5021,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s004-,ECMC_G=IOC_TEST:m0s004"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s004-,ECMC_G=IOC_TEST:m0s004,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=4,HWTYPE=EL5021,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "4+1","%d")
# Enable reset on c-latch (index track)
ecmcConfigOrDie "Cfg.EcAddSdo(4,0x8000,0x1,1,1)"
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "5")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=5, HW_DESC=EL3174_0to10V, SUBST_FILE=../db/telemessEddyCurrentSensors.substitutions"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "5")
epicsEnvSet("HW_DESC",            "EL3174_0to10V")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL3174_0to10V")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x0c663052")
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_generic.cm2022/10/19 15:21:34.826 OK
2022/10/19 15:21:34.935 OK
2022/10/19 15:21:34.942 OK
2022/10/19 15:21:34.942 OK
2022/10/19 15:21:34.944 OK
2022/10/19 15:21:34.945 OK
2022/10/19 15:21:34.946 OK
2022/10/19 15:21:34.946 OK
2022/10/19 15:21:34.947 OK
2022/10/19 15:21:34.947 OK
2022/10/19 15:21:34.956 OK
2022/10/19 15:21:34.956 OK
2022/10/19 15:21:34.959 OK
2022/10/19 15:21:34.960 OK
d,1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_generic.cmd
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd "RESET=true"
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,5,0x2,0x0c663052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "true>0","","#- ")
ecmcConfigOrDie "Cfg.EcWriteSdo(5,0x1011,0x1,1684107116,4)"
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_pdos.cmd",1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_pdos.cmd
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogInput_16bit.cmd "CH_ID=01,ECMC_PDO=0x1a00,ECMC_ENTRY=0x6000"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",01,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a00,0x6000,0x01,U16,status01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a00,0x6000,0x11,S16,analogInput01)"
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogInput_16bit.cmd "CH_ID=02,ECMC_PDO=0x1a02,ECMC_ENTRY=0x6010"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",02,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a02,0x6010,0x01,U16,status02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a02,0x6010,0x11,S16,analogInput02)"
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogInput_16bit.cmd "CH_ID=03,ECMC_PDO=0x1a04,ECMC_ENTRY=0x6020"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",03,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a04,0x6020,0x01,U16,status03)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a04,0x6020,0x11,S16,analogInput03)"
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogInput_16bit.cmd "CH_ID=04,ECMC_PDO=0x1a06,ECMC_ENTRY=0x6030"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",04,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a06,0x6030,0x01,U16,status04)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(5,0x2,0x0c663052,2,3,0x1a06,0x6030,0x11,S16,analogInput04)"
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V-Sensor-chX.cmd",1)
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x800D")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x800D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x800D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x801D")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x801D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x801D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x802D")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ec2022/10/19 15:21:34.960 OK
2022/10/19 15:21:34.960 OK
2022/10/19 15:21:34.961 OK
2022/10/19 15:21:34.961 OK
2022/10/19 15:21:34.981 OK
mccfg/8.0.0+0/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x802D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x802D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x803D")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3174_0to10V-Sensor-chX.cmd
############################################################
############# Parmetrization Default SDO settings for EL3174
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x0E")  # 0..10V
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x803D,0x11,0x0E,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0x00")  # Extended Range
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x803D,0x12,0x00,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=5,HWTYPE=EL3174_0to10V"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "5","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s005")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s005-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=../db/telemessEddyCurrentSensors.substitutions,ECMC_P=IOC_TEST:m0s005-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(../db/telemessEddyCurrentSensors.substitutions,1,1)
dbLoadTemplate(../db/telemessEddyCurrentSensors.substitutions,"ECMC_P=IOC_TEST:m0s005-,ECMC_G=IOC_TEST:m0s005,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=5,HWTYPE=EL3174_0to10V,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s005-,ECMC_G=IOC_TEST:m0s005"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s005-,ECMC_G=IOC_TEST:m0s005,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=5,HWTYPE=EL3174_0to10V,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "5+1","%d")
# Configure analog sensors common (filter settings valid for all channles)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL31XX-Sensor-common.cmd
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8000")
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x15")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")       # 50Hz
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x15,0,2)"
# Example of default configuration of analog sensor CH0
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8000")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3164-Sensor-chX-default.cmd
############################################################2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.985 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.986 OK
2022/10/19 15:21:34.988 OK
2022/10/19 15:21:34.988 OK
2022/10/19 15:21:34.988 OK
2022/10/19 15:21:34.988 OK

############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8000,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH1
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8010")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x6,0,1)"
epicsEnvSet("ECMC_2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.989 OK
2022/10/19 15:21:34.990 OK
2022/10/19 15:21:34.990 OK
2022/10/19 15:21:34.990 OK
2022/10/19 15:21:34.990 OK
2022/10/19 15:21:34.990 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8010,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH2
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8020")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epic2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.991 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.992 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.993 OK
2022/10/19 15:21:34.994 OK
sEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x17,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8020,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
# Example of default configuration of analog sensor CH3
epicsEnvSet("ECMC_EC_SDO_INDEX",         "0x8030")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL3164-Sensor-chX-default.cmd
############################################################
############# Parmetrization Default SDO settings for EL3164
#
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x1")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x1,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x2")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Signed
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x2,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x5,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x6")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x6,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x7")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x7,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x8")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x8,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xA")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")  # Disabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0xA,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0xB")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")  # Enabled
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0xB,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x11")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x11,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x12")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x12,65536,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x13")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x13,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x14")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x14,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x17")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x17,0,2)"
epicsEnvSet("ECMC_EC2022/10/19 15:21:34.994 OK
2022/10/19 15:21:34.998 OK
2022/10/19 15:21:35.005 OK
2022/10/19 15:21:35.010 OK
2022/10/19 15:21:35.012 OK
_SDO_INDEX_OFFSET",  "0x18")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "65536")
ecmcConfigOrDie "Cfg.EcAddSdo(5,0x8030,0x18,65536,2)"
epicsEnvUnset("ECMC_EC_SDO_INDEX_OFFSET")
epicsEnvUnset("ECMC_EC_SDO_SIZE")
epicsEnvUnset("ECMC_EC_SDO_VALUE")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "6")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=6, HW_DESC=EL4122"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "6")
epicsEnvSet("HW_DESC",            "EL4122")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL4122.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL4122.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL4122")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x101a3052")
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd,1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd "RESET=true"
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,6,0x2,0x101a3052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "true>0","","#- ")
ecmcConfigOrDie "Cfg.EcWriteSdo(6,0x1011,0x1,1684107116,4)"
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogOutput_16bit.cmd,1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogOutput_16bit.cmd "CH_ID=01,ECMC_PDO=0x1600,ECMC_ENTRY=0x7000,ECMC_ENTRY_OFFSET=0x1"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",01,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(6,0x2,0x101a3052,1,2,0x1600,0x7000,0x1,S16,analogOutput01)"
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcAnalogOutput_16bit.cmd "CH_ID=02,ECMC_PDO=0x1601,ECMC_ENTRY=0x7010,ECMC_ENTRY_OFFSET=0x1"
ecmcEpicsEnvSetCalc("ECMC_CHANNEL",02,"%02x")
ecmcConfigOrDie "Cfg.EcAddEntryDT(6,0x2,0x101a3052,1,2,0x1601,0x7010,0x1,S16,analogOutput02)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=6,HWTYPE=EL4122"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "6","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s006")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s006-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEL4122.substitutions,ECMC_P=IOC_TEST:m0s006-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEL4122.substitutions,1,1)
dbLoadTemplate(ecmcEL4122.substitutions,"ECMC_P=IOC_TEST:m0s006-,ECMC_G=IOC_TEST:m0s006,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=6,HWTYPE=EL4122,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s006-,ECMC_G=IOC_TEST:m0s006"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s006-,ECMC_G=IOC_TEST:m0s006,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=6,HWTYPE=EL4122,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAUL2022/10/19 15:21:35.036 OK
2022/10/19 15:21:35.039 OK
2022/10/19 15:21:35.039 OK
T_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "6+1","%d")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "7")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=7, HW_DESC=EL9505"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "7")
epicsEnvSet("HW_DESC",            "EL9505")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL9505.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL9505.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL9505")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x25213052")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,7,0x2,0x25213052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddEntryComplete(7,0x2,0x25213052,2,0,0x1a00,0x6000,0x1,1,powerOk01)"
ecmcConfigOrDie "Cfg.EcAddEntryComplete(7,0x2,0x25213052,2,0,0x1a00,0x6000,0x2,1,overload01)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=7,HWTYPE=EL9505"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "7","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s007")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s007-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEL9505.substitutions,ECMC_P=IOC_TEST:m0s007-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEL9505.substitutions,1,1)
dbLoadTemplate(ecmcEL9505.substitutions,"ECMC_P=IOC_TEST:m0s007-,ECMC_G=IOC_TEST:m0s007,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=7,HWTYPE=EL9505,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s007-,ECMC_G=IOC_TEST:m0s007"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s007-,ECMC_G=IOC_TEST:m0s007,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=7,HWTYPE=EL9505,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "7+1","%d")
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 1)
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "8")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=8, HW_DESC=EL1252"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "8")
epicsEnvSet("HW_DESC",            "EL1252")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL1252.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEL1252.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL1252")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x04e43052")
iocshLo2022/10/19 15:21:35.059 OK
2022/10/19 15:21:35.063 OK
2022/10/19 15:21:35.063 OK
2022/10/19 15:21:35.064 OK
2022/10/19 15:21:35.065 OK
2022/10/19 15:21:35.065 OK
2022/10/19 15:21:35.065 OK
2022/10/19 15:21:35.065 OK
2022/10/19 15:21:35.065 OK
ad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,8,0x2,0x04e43052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcEX1002.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,0,0x1a00,0x6000,0x1,B1,binaryInput01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,0,0x1a01,0x6010,0x1,B1,binaryInput02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xae,U8,status01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xaf,U8,status02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb0,U64,timestampLatchPositive01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb8,U64,timestampLatchNegative01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc0,U64,timestampLatchPositive02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(8,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc8,U64,timestampLatchNegative02)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=8,HWTYPE=EL1252"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "8","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s008")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s008-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcEL1252.substitutions,ECMC_P=IOC_TEST:m0s008-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEL1252.substitutions,1,1)
dbLoadTemplate(ecmcEL1252.substitutions,"ECMC_P=IOC_TEST:m0s008-,ECMC_G=IOC_TEST:m0s008,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=8,HWTYPE=EL1252,T_SMP_MS=1,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s008-,ECMC_G=IOC_TEST:m0s008"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s008-,ECMC_G=IOC_TEST:m0s008,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=8,HWTYPE=EL1252,T_SMP_MS=1,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "8+1","%d")
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 100)
##Add optic sensor
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "11")
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/addSlave.cmd, "SLAVE_ID=11, HW_DESC=OptoILD2300_50mm"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "11")
epicsEnvSet("HW_DESC",            "OptoILD2300_50mm")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcOptoILD2300_50mm.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcOptoILD2300_50mm.cmd" "NELM=1"
epicsEnvSet("ECMC_EC_HWTYPE"             "OptoILD2300_50mm")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x00000607")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x003ede74")
ecmcFileExist(/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd,1)
iocshLoad /epics/base-7.02022/10/19 15:21:35.092 OK
2022/10/19 15:21:35.094 OK
2022/10/19 15:21:35.107 OK
2022/10/19 15:21:35.108 OK
2022/10/19 15:21:35.108 OK
2022/10/19 15:21:35.108 OK
2022/10/19 15:21:36.129 EtherCAT bus ready (not scaning).
2022/10/19 15:21:36.129 INFO: Locking memory
2022/10/19 15:21:36.129 WARNING: mlockall() failed (0x20045).
2022/10/19 15:21:36.144 Starting up EtherCAT bus: 0 second(s). Max wait time 30 second(s).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 0: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 1: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 2: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 3: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 4: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 5: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 6: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 7: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 8: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 11: Not operational (0x24011).
2022/10/19 15:21:36.230 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/10/19 15:21:37.144 Starting up EtherCAT bus: 1 second(s). Max wait time 30 second(s).
2022/10/19 15:21:37.948 ../devEcmcSup/main/ecmcError.cpp/errorReset:103: NO_ERROR (0x0).
2022/10/19 15:21:39.145 EtherCAT bus started!
2022/10/19 15:21:39.145 OK
2022/10/19 15:21:39.146 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocBuild (0). Allow callbacks: true.
Starting iocInit
2022/10/19 15:21:39.146 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtBeginning (1). Allow callbacks: true.
2022/10/19 15:21:39.147 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCallbackInit (2). Allow callbacks: true.
2022/10/19 15:21:39.147 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaLinkInit (3). Allow callbacks: true.
2022/10/19 15:21:39.147 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDrvSup (4). Allow callbacks: true.
2022/10/19 15:21:39.147 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitRecSup (5). Allow callbacks: true.
2022/10/19 15:21:39.148 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDevSup (6). Allow callbacks: true.
2022/10/19 15:21:39.149 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.reset linked to record (asyn reason 1).
2022/10/19 15:21:39.150 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s6.analogOutput01 linked to record (asyn reason 2).
2022/10/19 15:21:39.150 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s6.analogOutput02 linked to record (asyn reason 3).
2022/10/19 15:21:39.150 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.encoderStatus01 linked to record (asyn reason 4).
2022/10/19 15:21:39.150 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.status01 linked to record (asyn reason 5).
2022/10/19 15:21:39.151 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.status02 linked to record (asyn reason 6).
2022/10/19 15:21:39.151 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.status03 linked to record (asyn reason 7).
2022/10/19 15:21:39.151 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.status04 linked to record (asyn reason 8).
2022/10/19 15:21:39.151 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.status01 linked to record (asyn reason 9).
2022/10/19 15:21:39.151 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.status02 linked to record (asyn reason 10).
2022/10/19 15:21:39.152 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.msg linked to record (asyn reason 11).
2022/10/19 15:21:39.152 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.updated linked to record (asyn reason 12).
2022/10/19 15:21:39.152 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.slavestatus linked to record (asyn reason 13).
2022/10/19 15:21:39.153 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.slavestatus linked to record (asyn reason 14).
2022/10/19 15:21:39.153 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.slavestatus linked to record (asyn reason 15).
2022/10/19 15:21:39.154 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.slavestatus linked to record (asyn reason 16).
2022/10/19 15:21:39.154 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.slavestatus linked to record (asyn reason 17).
2022/10/19 15:21:39.154 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.slavestatus linked to record (asyn reason 18).
2022/10/19 15:21:39.155 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s6.slavestatus linked to record (asyn reason 19).
2022/10/19 15:21:39.155 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s7.slavestatus linked to record (asyn reason 20).
2022/10/19 15:21:39.156 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.slavestatus linked to record (asyn reason 21).
2022/10/19 15:21:39.156 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s11.slavestatus linked to record (asyn reason 22).
2022/10/19 15:21:39.156 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.masterstatus linked to record (asyn reason 23).
2022/10/19 15:21:39.157 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.slavecounter linked to record (asyn reason 24).
2022/10/19 15:21:39.157 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.memmapcounter linked to record (asyn reason 25).
2022/10/19 15:21:39.158 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainfailcountertotal linked to record (asyn reason 26).
2022/10/19 15:21:39.158 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.entrycounter linked to record (asyn reason 27).
2022/10/19 15:21:39.159 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainstatus linked to record (asyn reason 28).
2022/10/19 15:21:39.160 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s7.powerOk01 linked to record (asyn reason 29).
2022/10/19 15:21:39.161 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s7.overload01 linked to record (asyn reason 30).
2022/10/19 15:21:39.162 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.binaryInput01 linked to record (asyn reason 31).
2022/10/19 15:21:39.164 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.binaryInput02 linked to record (asyn reason 32).
2022/10/19 15:21:39.165 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.ok linked to record (asyn reason 33).
2022/10/19 15:21:39.167 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.ONE linked to record (asyn reason 34).
2022/10/19 15:21:39.169 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s0.ZERO linked to record (asyn reason 35).
2022/10/19 15:21:39.170 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.ONE linked to record (asyn reason 36).
2022/10/19 15:21:39.171 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.ZERO linked to record (asyn reason 37).
2022/10/19 15:21:39.173 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ONE linked to record (asyn reason 38).
2022/10/19 15:21:39.174 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ZERO linked to record (asyn reason 39).
2022/10/19 15:21:39.175 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.ONE linked to record (asyn reason 40).
2022/10/19 15:21:39.176 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s3.ZERO linked to record (asyn reason 41).
2022/10/19 15:21:39.178 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.ONE linked to record (asyn reason 42).
2022/10/19 15:21:39.179 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.ZERO linked to record (asyn reason 43).
2022/10/19 15:21:39.180 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.ONE linked to record (asyn reason 44).
2022/10/19 15:21:39.182 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.ZERO linked to record (asyn reason 45).
2022/10/19 15:21:39.183 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s6.ONE linked to record (asyn reason 46).
2022/10/19 15:21:39.185 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s6.ZERO linked to record (asyn reason 47).
2022/10/19 15:21:39.187 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s7.ONE linked to record (asyn reason 48).
2022/10/19 15:21:39.188 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s7.ZERO linked to record (asyn reason 49).
2022/10/19 15:21:39.190 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.ONE linked to record (asyn reason 50).
2022/10/19 15:21:39.192 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.ZERO linked to record (asyn reason 51).
2022/10/19 15:21:39.194 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s11.ONE linked to record (asyn reason 52).
2022/10/19 15:21:39.196 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s11.ZERO linked to record (asyn reason 53).
.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,11,0x00000607,0x003ede74)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
ecmcConfigOrDie "Cfg.EcAddEntryDT(11,0x00000607,0x003ede74,2,3,0x1a00,0x6065,0x5,S32,analogInput01,1)"
# deduce what the prefix should be
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd",1)
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=11,HWTYPE=OptoILD2300_50mm"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "11","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_TEST:m0s011")
epicsEnvSet("ECMC_P",            "IOC_TEST:m0s011-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applySubstitutions.cmd" "SUBST_FILE=ecmcOptoILD2300_50mm.substitutions,ECMC_P=IOC_TEST:m0s011-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcOptoILD2300_50mm.substitutions,1,1)
dbLoadTemplate(ecmcOptoILD2300_50mm.substitutions,"ECMC_P=IOC_TEST:m0s011-,ECMC_G=IOC_TEST:m0s011,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=11,HWTYPE=OptoILD2300_50mm,T_SMP_MS=100,TSE=-2,NELM=1")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_TEST:m0s011-,ECMC_G=IOC_TEST:m0s011"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmcEcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_TEST:m0s011-,ECMC_G=IOC_TEST:m0s011,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=11,HWTYPE=OptoILD2300_50mm,T_SMP_MS=100,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "11+1","%d")
#Apply hardware configuration
ecmcConfigOrDie "Cfg.EcApplyConfig(1)"
dbLoadRecords("testAdmin.db","P=IOC_TEST:")
##############################################################################
## Configure diagnostics:
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
##############################################################################
## go active
iocshLoad (/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/setAppMode.cmd)
#==============================================================================
# setAppMode.cmd
ecmcFileExist("/epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/general.cmd",1)
iocshLoad /epics/base-7.0.6.1/require/4.0.0/siteMods/ecmccfg/8.0.0+0/general.cmd
#==============================================================================
# general.cmd
ecmcFileExist("ecmcGeneral.db",1,1)
dbLoadRecords("ecmcGeneral.db","P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=100,TSE=-2,ECMC_PROC_HOOK=")
# Examples of commands for info:
# ecmcReport <level> or asynReport <level>
# ecmcReport 3
# ecmcGrepParam <pattern>
# List all ecmc params for ethercat slave 2:
# ecmcGrepParam *s2*
#
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("ecmcEc.db",1,1)
 dbLoadRecords("ecmcEc.db","P=IOC_TEST:,ECMC_EC_MP=m,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,T_SMP_MS=100,TSE=-2")
ecmcConfigOrDie "Cfg.SetAppMode(1)"
iocInit()
############################################################################
## EPICS R7.0.6.1-E3-7.0.6.1-patch
## Rev. 2022-03-11T15:27+0100
############################################################################
ECATtimestamp aSubRecord: IOC_TEST:m0s008-BI01-TimeRiseTS
ECATtimestamp aSubRecord: IOC_TEST:m0s008-BI01-TimeFallTS
ECATtimestamp aSubRecord: IOC_TEST:m0s008-BI02-TimeRiseTS
ECATtimestamp aSubRecord: IOC_TEST:m0s008-BI02-TimeFallTS
2022/10/19 15:21:39.198 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.analogInput01 linked to record (asyn reason 54).
2022/10/19 15:21:39.199 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s4.positionActual01 linked to record (asyn reason 55).
2022/10/19 15:21:39.201 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.analogInput01 linked to record (asyn reason 56).
2022/10/19 15:21:39.202 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.analogInput02 linked to record (asyn reason 57).
2022/10/19 15:21:39.204 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.analogInput03 linked to record (asyn reason 58).
2022/10/19 15:21:39.206 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s5.analogInput04 linked to record (asyn reason 59).
2022/10/19 15:21:39.210 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.timestampLatchPositive01 linked to record (asyn reason 60).
2022/10/19 15:21:39.212 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.timestampLatchNegative01 linked to record (asyn reason 61).
2022/10/19 15:21:39.213 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.timestampLatchPositive02 linked to record (asyn reason 62).
2022/10/19 15:21:39.215 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s8.timestampLatchNegative02 linked to record (asyn reason 63).
2022/10/19 15:21:39.216 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s11.analogInput01 linked to record (asyn reason 64).
2022/10/19 15:21:39.219 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.appmode linked to record (asyn reason 65).
2022/10/19 15:21:39.221 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.id linked to record (asyn reason 66).
2022/10/19 15:21:39.222 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.min linked to record (asyn reason 67).
2022/10/19 15:21:39.224 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.max linked to record (asyn reason 68).
2022/10/19 15:21:39.226 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.min linked to record (asyn reason 69).
2022/10/19 15:21:39.228 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.max linked to record (asyn reason 70).
2022/10/19 15:21:39.230 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.min linked to record (asyn reason 71).
2022/10/19 15:21:39.232 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.max linked to record (asyn reason 72).
2022/10/19 15:21:39.234 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.min linked to record (asyn reason 73).
2022/10/19 15:21:39.237 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.max linked to record (asyn reason 74).
2022/10/19 15:21:39.248 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDatabase (7). Allow callbacks: true.
2022/10/19 15:21:39.248 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterFinishDevSup (8). Allow callbacks: true.
2022/10/19 15:21:39.750 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterScanInit (9). Allow callbacks: true.
2022/10/19 15:21:39.751 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitialProcess (10). Allow callbacks: true.
2022/10/19 15:21:39.752 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (11). Allow callbacks: true.
2022/10/19 15:21:39.752 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocBuilt (12). Allow callbacks: true.
2022/10/19 15:21:39.752 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocRun (13). Allow callbacks: true.
2022/10/19 15:21:39.752 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterDatabaseRunning (14). Allow callbacks: true.
2022/10/19 15:21:39.753 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInterruptAccept (28). Allow callbacks: true.
2022/10/19 15:21:39.753 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaServerRunning (15). Allow callbacks: true.
2022/10/19 15:21:39.753 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (29). Allow callbacks: true.
iocRun: All initialization complete
2022/10/19 15:21:39.754 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocRunning (16). Allow callbacks: true.
##############################################################################
## Store Records to file
dbl > pvs.log
# Set the IOC Prompt String One 
epicsEnvSet IOCSH_PS1 "mcag-trgt-muts--23736 > "
#
[?1034hmcag-trgt-muts--23736 > dbgrep *as[K[Ks002*
IOC_TEST:m0s002-Stat_
IOC_TEST:m0s002-Stat
IOC_TEST:m0s002-Online
IOC_TEST:m0s002-Operational
IOC_TEST:m0s002-Alstate-Init
IOC_TEST:m0s002-Alstate-Preop
IOC_TEST:m0s002-Alstate-Safeop
IOC_TEST:m0s002-Alstate-Op
IOC_TEST:m0s002-EntryCntr
IOC_TEST:m0s002-One
IOC_TEST:m0s002-Zero
IOC_TEST:m0s002-HWType
IOC_TEST:m0s002-Enc01-PosAct
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         49.720112 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         47.08484  
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.939592 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.857584 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.793936 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.719272 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.637672 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.579328 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.508744 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.443056 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.339016 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.27088  
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.201112 
mcag-trgt-muts--23736 > dbgf IOC_TEST:m0s002-Enc01-PosAct
DBF_DOUBLE:         46.12196  
mcag-trgt-muts--23736 > 